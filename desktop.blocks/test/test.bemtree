block('test').content()(function() {
    return this.doAsync(function() {
        var defer = Vow.defer(),
            promise = defer.promise();

        setTimeout(function() {
            var content = applyCtx({
                block: 'test2' // gets content via its own bemtree template
            });

            Vow.isPromise(content.content) ?
                content.content.then(function(result) {
                    content.content = result;
                    defer.resolve(content);
                }) : defer.resolve(content);

        }, 10);

        return promise;
    });
});
